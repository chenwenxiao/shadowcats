var box2d;collie.util.addEventListener(window,"load",function(){oConsole=new collie.FPSConsole({isSimple:!0,color:"#fff"});var e=collie.util.queryString(),t={width:document.body.clientWidth,height:document.body.clientHeight};collie.Renderer.DEBUG_RENDERING_MODE="undefined"!=typeof e.dom?"dom":"undefined"!=typeof e.canvas?"canvas":"auto",collie.Renderer.RETINA_DISPLAY=!1,collie.ImageManager.add("yame","/images/yame_walk.png");var o=new collie.Layer({width:t.width,height:t.height});box2d=new collie.Box2d(t.width,t.height,30),box2d.addFixture("rabbit",{density:1,friction:.5,restitution:0}),box2d.addFixture("ground",{density:1,friction:.5,restitution:.2}),box2d.createWall("right"),box2d.createWall("left"),box2d.createWall("top"),box2d.createWall("bottom","ground");for(var i,l,a,d=0;2>d;d++)i=new collie.DisplayObject({width:129.4,height:165,x:Math.random()*(t.width-129.4)|0,y:Math.random()*(t.height-165)|0,useEvent:!0,backgroundImage:"yame",hitArea:[[48,51],[46,13],[54,14],[56,45],[70,45],[70,16],[79,16],[79,52],[81,131],[81,140],[69,141],[66,117],[65,142],[53,144],[52,111],[45,97],[44,74]]}).addTo(o),collie.Timer.cycle(i,"18fps",{to:8}),l=box2d.createObject(i,{width:50,height:130},"rabbit");a=l,a.SetFixedRotation(!0);var c={left:!1,right:!1},n=null;o.attach({mousedown:function(e){if(e.displayObject){var t=box2d.getBody(e.displayObject);n=box2d.createMouseJoint(t,collie.Box2d.vec2(e.x,e.y,!0),{maxForce:300*t.GetMass()}),t.SetAwake(!0)}},mousemove:function(e){n&&n.SetTarget(collie.Box2d.vec2(e.x,e.y,!0))},mouseup:function(e){n&&(box2d.removeJoint(n),n=null)},click:function(e){var t=new collie.DisplayObject({width:129.4,height:165,x:e.x-64.7,y:e.y-82.5,useEvent:!0,backgroundImage:"yame",hitArea:[[48,51],[46,13],[54,14],[56,45],[70,45],[70,16],[79,16],[79,52],[81,131],[81,140],[69,141],[66,117],[65,142],[53,144],[52,111],[45,97],[44,74]]}).addTo(o);collie.Timer.cycle(t,"18fps",{to:8});box2d.createObject(t,{width:50,height:130},"rabbit")}}),collie.util.addEventListener(document.body,"keydown",function(e){var t=e.keyCode||e.key.charCodeAt(0);switch(a.SetAwake(!0),t){case 68:c.right=!0;break;case 65:c.left=!0;break;case 87:var o=a.GetLinearVelocity();a.SetLinearVelocity(collie.Box2d.vec2(o.x,-15),a.GetWorldCenter())}}),collie.util.addEventListener(document.body,"keyup",function(e){var t=e.keyCode||e.key.charCodeAt(0),o=a.GetLinearVelocity();switch(t){case 68:c.right=!1,a.SetLinearVelocity(collie.Box2d.vec2(0,o.y));break;case 65:c.left=!1,a.SetLinearVelocity(collie.Box2d.vec2(0,o.y))}}),oConsole.load(),collie.Renderer.addLayer(o),collie.Renderer.load(document.getElementById("collie_container")),collie.Renderer.start("30fps",function(){var e=a.GetLinearVelocity();c.left&&a.SetLinearVelocity(collie.Box2d.vec2(-10,e.y)),c.right&&a.SetLinearVelocity(collie.Box2d.vec2(10,e.y))}),box2d.load(!1)});